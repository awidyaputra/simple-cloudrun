substitutions:
  _PROJECT_ID: 'gen-lang-client-0713161089' # TODO: update to your Google Cloud project ID
  _REGION: 'europe-west1' # TODO: update to your region
  _SERVICE: 'simple-run' # TODO: update to your service name
  _IMAGE_NAME: "europe-west1-docker.pkg.dev/gen-lang-client-0713161089/simple-repo/simple-run"

steps:
# Build the image
- name: 'gcr.io/cloud-builders/docker'
  args: ['build', '-t', '${_IMAGE_NAME}', '.']
# Push the image to Artifact Registry
- name: 'gcr.io/cloud-builders/docker'
  args: ['push', '${_IMAGE_NAME}']
# Deploy image to Cloud Run
- name: 'gcr.io/google.com/cloudsdktool/cloud-sdk'
  entrypoint: gcloud
  args: ['run', 'deploy', '${_SERVICE}', '--image', '${_IMAGE_NAME}', '--region', '${_REGION}']
images:
- '${_IMAGE_NAME}'

options:
  logging: CLOUD_LOGGING_ONLY
